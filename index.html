<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A GitHub Powered Blogging Platform Where You Can Make A Post By Creating A New Discussion">
    <meta name="google-site-verification" content="7YiubERgaN8UtgdeR5wA3DPIY8cN4lQLJF37hXYNMSw" />
    <title>Stufz</title>
    <link rel="stylesheet" href="posts/assets/css/main.css">
    <style>
    .post {
        cursor: pointer;
        margin-bottom: 1.5em;
    }

    .post h2 {
        font-size: 1.2em;
        margin-bottom: 0.3em;
    }

    .post p.preview {
        font-size: 1em;
        color: #333;
        line-height: 1.4em;
    }
    </style>
</head>
<body>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/themium/FrameworkV0@main/v0.css">
    <header style="margin: 0; display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; background: #3c4047; color: #fff;" class="tf_f-ubuntu">
        <div>
        <h2 class="tf_fw-300" style="margin: 0; text-align: left;">Stufz</h2>
        <p style="margin: 0; font-size: 1rem; opacity: 0.8; text-align: left;">A Blog Powered By DisBlog</p>
        </div>
        <nav style="display: flex; align-items: center; gap: 1.5rem;">
        <a href="/Blog/" style="color: #fff; text-decoration: none;">Posts</a>
        </nav>
    </header>
    <h1>Stufz</h1>
    <span class="subtitle">My Blog (StuffzEZ)</span>
    <div class="marbot30"></div>
    <hr>
    <p>hi im StuffzEZ! i make cool stuff.</p>
    <div id="posts" class="posts-container"></div>

    <script>
    // ðŸ”§ Change these values to your repo details
    const repoUser = "StuffzEZ";
    const repoName = "Blog";
    const branch = "main";

    async function loadPosts() {
        const container = document.getElementById("posts");

        try {
        // Get list of files in posts/ from GitHub API
        const apiUrl = `https://api.github.com/repos/${repoUser}/${repoName}/contents/posts?ref=${branch}`;
        const apiRes = await fetch(apiUrl);
        if (!apiRes.ok) throw new Error("Failed to fetch repo contents");
        const files = await apiRes.json();

        // Filter only .html files
        const htmlFiles = files.filter(f => f.name.endsWith(".html"));

        if (htmlFiles.length === 0) {
            container.innerHTML = `<p class="noposts">There are no posts yet.</p>`;
            return;
        }

        for (const file of htmlFiles) {
            // Build raw file URL
            const rawUrl = `https://raw.githubusercontent.com/${repoUser}/${repoName}/refs/heads/${branch}/posts/${file.name}`;
            const res = await fetch(rawUrl);
            if (!res.ok) throw new Error("Failed to fetch " + file.name);
            const text = await res.text();

            // Parse HTML
            const parser = new DOMParser();
            const doc = parser.parseFromString(text, "text/html");

            const title = doc.querySelector("#title-forpost")?.innerText || "Untitled";
            const content = doc.querySelector("#maincontent-forpost")?.innerText || "";

            // Make preview (first 200 characters)
            const preview = content.length > 200 ? content.slice(0, 200) + "..." : content;

            // Remove .html extension for link
            const postId = file.name.replace(".html", "");

            // Create post element
            const div = document.createElement("div");
            div.className = "post";
            div.innerHTML = `
            <h2>${title}</h2>
            <p class="preview">${preview}</p>
            `;

            // Make clickable
            div.addEventListener("click", () => {
            window.location.href = `posts/${postId}`;
            });

            container.appendChild(div);
        }
        } catch (err) {
        console.error(err);
        container.innerHTML = `<p class="noposts">Error loading posts.</p>`;
        }
    }

    loadPosts();
    </script>
</body>
</html>